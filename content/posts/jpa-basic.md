---
title: "Jpa Basic"
categories: ["java"]
tags: ["자바ORM표준JPA프로그래밍"]
date: 2021-11-16T10:15:30+09:00
draft: true
---

## 필드, 칼럼 매핑

| 분류             | 매핑 어노테이션 | 설명                                       |
| ---------------- | --------------- | ------------------------------------------ |
| 필드와 칼럼 매핑 | @Column         | 칼럼을 매핑한다                            |
|                  | @Enumerated     | 자바의 enum 타입을 매핑한다                |
|                  | @Temporal       | 날짜 타입을 매핑한다                       |
|                  | @Lob            | BLOB, CLOB 타입을 매핑한다                 |
|                  | @Transient      | 특정 필드를 데이터베이스에 매핑하지 않는다 |
| 기타             | @Access         | JPA가 엔티티에 접근하는 방식을 지정한다    |

### @Column

| 속성                            | 기능                                                                                                                                                                                                                                 | 기본값                                                              |
| ------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------- |
| name                            | 필드와 매핑할 테이블의 칼럼 이름                                                                                                                                                                                                     | 객체의 필드 이름                                                    |
| insertalbe (거의 사용하지 않음) | 엔티티 저장 시 이 필드도 같이 저장한다                                                                                                                                                                                               | true                                                                |
| updatable (거의 사용하지 않음)  | 엔티티 저장 시 이 필드도 같이 수정한다                                                                                                                                                                                               | true                                                                |
| table (거의 사용하지 않음)      | 하나의 엔티티를 두 개 이상의 테이블에 매핑할 때 사용한다                                                                                                                                                                             | 현재 클래스가 매핑된 테이블                                         |
| nullable(DDL)                   | null 값의 허용 여부를 설정한다. false로 설정하면 DDL 생성 시에 not null 제약조건이 붙는다                                                                                                                                            | true                                                                |
| unique(DDL)                     | @Table의 uniqueConstraints와 같지만 한 칼럼에 간단히 유니크 제약조건을 걸 때 사용한다. 만약 두 칼럼 이상을 사용해서 유니크 제약조건을 사용하려면 클래스 레벨에서 @Table.uniqueConstraints를 사용해야 한다                            |                                                                     |
| colomnDefinition(DDL)           | 데이터베이스 칼럼 정보를 직접 줄 수 있다                                                                                                                                                                                             | 필드의 자바 타입과 방언 정보를 사용해서 적절한 칼럼 타입을 생성한다 |
| length(DDL)                     | 문자 길이 제약조건, String 타입에만 사용한다                                                                                                                                                                                         | 255                                                                 |
| precision, scale(DDL)           | BigDecimal 타입에서 사용한다(BigInterger도 사용할 수 있다). ercision은 소수점을 포함한 전체 자릿수를, scale은 소수의 자릿수다. 참고로 double, float 타입에는 적용되지 않는다. 아주 큰 숫자나 정밀한 소수를 다루어야 할 때만 사요한다 | precision=19, scalee=2                                              |

## 영속성 관리

### 엔티티 메니저

엔티티 메니저는 엔티티를 저장하고, 수정하고, 삭제하고, 조회하는 등 엔티티와 관련된 모든 일을 처리한다.
엔티티 메니저는 데이터베이스 연결이 꼭 필요한 시점까지 연결하지 않는다.

- ## 엔티티 생명주기

  - ### 비영속
    영속성 컨텍스트와 전혀 관계가 없는 상태
  - ### 영속
    영속성 컨텐스트에 저장된 상태
  - ### 준영속
    영속성 컨텍스트에 저장되었다 분리된 상태
  - ### 삭제

- ## flush

트랜잭션을 커밋하는 순간 영속성 컨텐ㅅ트에 새로 저장된 엔티티를 데이터베이스에 반영하는 것

- ## 영속성 컨텍스트 엔티티 관리 장점

  - 1차 캐시
  - 동일성 보장
  - 트랜잭션을 지원하는 쓰기 지연
  - 변경 감지
  - 지연 로딩

- ## 1차 캐시
  영속성 컨텍스트 내부에 가지고 있는 캐시. 영속 상태의 엔티티는 모두 이곳에 저장.
